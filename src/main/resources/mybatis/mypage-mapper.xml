<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mypage">
	
	<select id="selectUser" parameterType="int" resultType="userDto">
		SELECT * FROM W_USER
		WHERE USNO = #{usNo}
	</select>

	<select id="cashRecord" parameterType="com.commons.Criteria" resultType="chargeHistoryDto">
		SELECT CHNO, USNO, CHCASH, CHDATE, CHBANK 
		FROM (
        		SELECT CHNO, USNO, CHCASH, CHDATE, CHBANK, ROW_NUMBER() OVER(ORDER BY CHNO DESC) AS RNUM
        		FROM W_CHARGEHISTORY
        		WHERE USNO=#{usNo}
        		AND CHDATE BETWEEN TO_DATE(#{startDate}) AND TO_DATE(#{endDate}) + INTERVAL '1' DAY
        		)
		WHERE RNUM BETWEEN #{rowStart} AND #{rowEnd}
		ORDER BY CHNO DESC
	</select>

	<select id="cashRecordCount" parameterType="com.commons.Criteria" resultType="int">
		SELECT COUNT(CHNO)
		FROM W_CHARGEHISTORY
		WHERE CHNO > 0
		AND USNO = #{usNo}
		AND CHDATE BETWEEN TO_DATE(#{startDate}) AND TO_DATE(#{endDate}) + INTERVAL '1' DAY
	</select>


</mapper>